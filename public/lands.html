<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#4CAF50">
  <title>Money Game - Lands</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="manifest" href="/manifest.json">
</head>

<body class="home-page">
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-logo">üí∞ Money Game</div>
      <ul class="nav-menu">
        <li><a href="home.html">Home</a></li>
        <li><a href="paybal-wallet.html">Wallet</a></li>
        <li><a href="shares.html">Shares</a></li>
        <li><a href="shop.html">Shop</a></li>
        <li><a href="javascript:logout()" class="logout-btn">Logout</a></li>
      </ul>
    </div>
  </nav>
  <div class="container">
    <div class="login-box" style="width: 100%; max-width: 800px;">
      <div class="login-header">
        <h1>üèûÔ∏è Real Estate Market</h1>
        <p>Invest in properties to earn passive income.</p>
      </div>

      <div id="landsList"
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
        <!-- Loading... -->
        <p style="text-align:center; width:100%;">Loading properties...</p>
      </div>

      <div style="margin-top: 30px; text-align: center;">
        <a href="home.html" class="btn btn-secondary">Back to Dashboard</a>
      </div>
    </div>
  </div>
  <script>
    async function loadLands() {
      try {
        const res = await fetch('/api/game/lands');
        const lands = await res.json();
        const container = document.getElementById('landsList');
        container.innerHTML = '';

        if (lands.length === 0) {
          container.innerHTML = '<p>No properties available currently.</p>';
          return;
        }

        lands.forEach(land => {
          const card = document.createElement('div');
          card.className = 'upgrade-item'; // repurpose existing class or add style
          card.style.background = '#333';
          card.style.padding = '15px';
          card.style.borderRadius = '10px';
          card.style.textAlign = 'center';

          card.innerHTML = `
                    <h3 style="color: white; margin-bottom: 5px;">${land.name}</h3>
                    <p style="color: #aaa; font-size: 14px;">${land.type}</p>
                    <p style="color: gold; font-weight: bold; margin: 10px 0;">$${land.value.toLocaleString()}</p>
                    <button class="btn btn-small-primary" onclick="buyLand(${land.id})">Buy Property</button>
                `;
          container.appendChild(card);
        });
      } catch (e) {
        console.error(e);
      }
    }

    async function buyLand(id) {
      if (!confirm('Buy this property?')) return;
      try {
        const res = await fetch('/api/game/lands/buy', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ landId: id })
        });
        const data = await res.json();
        if (data.success) {
          alert('Property Purchased!');
          loadLands();
        } else {
          alert(data.error || 'Failed to buy');
        }
      } catch (e) {
        alert('Error');
      }
    }

    document.addEventListener('DOMContentLoaded', loadLands);
  </script>
  <script src="/js/pwa-setup.js"></script>
</body>

</html>